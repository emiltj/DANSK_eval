---
title: "plots_thesis"
output: html_document
date: "2023-03-14"
---

# LOAD PACKAGES
```{r}
library("pacman")
library("ggplot2")
install.packages("tidyverse")
library("tidyverse")

library("pacman")
library("pacman")
library("pacman")
library("pacman", "ggplot2", "tidyverse", "corrr", "RColorBrewer")
#pacman::p_load(ggplot2, tidyverse, corrr, RColorBrewer)
```

# CONFUSION MATRICES
DANSK vs interrater
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_final_interrater/conf_matrix.csv", header=T)

# Change column names
colnames(df)[1] <- "TAG"
colnames(df)[12] <- "NOT TAGGED"
colnames(df)[20] <- "WORK OF ART"

# Column to index/rownames
df <- df %>% column_to_rownames(., var = 'TAG')

# Make into wide format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Define levels
levels = ordered(colnames(df))

# Plot df_wide
ggplot(df_wide, aes(x = rowname, y = ordered(colname, levels=rev(levels)))) +
  
  # Fill colour with value
  geom_tile(aes(fill = value)) +
  
  # Colours of fill gradient. OOB = how to handle out of bounds.
  scale_fill_gradient2(low = "lightblue",
                       high = "red",
                       mid = "white",
                       midpoint = 150,
                       limit = c(0,300),
                       space = "Lab",
                       name="Number of annotations",
                       oob=scales::squish) +
  
  # Text on tiles with value number
  geom_text(aes(label = value), size = 3.5) + 
  
  # All cells equal size
  coord_fixed() +
  
  # Minimal theme to avoid weird borders
  theme_minimal() +
  
  # Labels on x-axis should be tilted (they overlap)
  theme(axis.text.x=element_text(angle = -90, hjust = 0, vjust = 0)) +
  
  # Labs
  labs(title = "DANSK and initial annotations",
       subtitle = "Confusion matrix with DANSK gold annotations and initial annotations",
       x = "Accumulate annotations of initial annotators", 
       y = "DANSK gold") #+
  
  # Theme and positioning
  # theme(plot.title = element_text(hjust = 0.5), 
  #       plot.subtitle = element_text(hjust = 0.5))

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_final_interrater/conf_matrix_plot.png")
```
Small
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/small_confusion_matrix.csv", header=T)

# Change column names
colnames(df)[1] <- "TAG"
colnames(df)[12] <- "NOT TAGGED"
colnames(df)[20] <- "WORK OF ART"

# Column to index/rownames
df <- df %>% column_to_rownames(., var = 'TAG')

# Make into wide format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Define levels
levels = ordered(colnames(df))

# Plot df_wide
ggplot(df_wide, aes(x = rowname, y = ordered(colname, levels=rev(levels)))) +
  
  # Fill colour with value
  geom_tile(aes(fill = value)) +
  
  # Colours of fill gradient. OOB = how to handle out of bounds.
  scale_fill_gradient2(low = "lightblue",
                       high = "red",
                       mid = "white",
                       midpoint = 25,
                       limit = c(0,50),
                       space = "Lab",
                       name="Number of annotations",
                       oob=scales::squish) +
  
  # Text on tiles with value number
  geom_text(aes(label = value), size = 3.5) + 
  
  # All cells equal size
  coord_fixed() +
  
  # Minimal theme to avoid weird borders
  theme_minimal() +
  
  # Labels on x-axis should be tilted (they overlap)
  theme(axis.text.x=element_text(angle = -90, hjust = 0, vjust = 0)) +
  
  # Labs
  labs(title = "Prediction errors - small model",
       subtitle = "Confusion matrix of da_dacy_small_ner_fine_grained",
       x = "da_dacy_small_ner_fine_grained", 
       y = "DANSK gold") #+
  
  # Theme and positioning
  # theme(plot.title = element_text(hjust = 0.5), 
  #       plot.subtitle = element_text(hjust = 0.5))


# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/small_confusion_matrix_plot.png")
```
Medium
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/medium_confusion_matrix.csv", header=T)

# Change column names
colnames(df)[1] <- "TAG"
colnames(df)[12] <- "NOT TAGGED"
colnames(df)[20] <- "WORK OF ART"

# Column to index/rownames
df <- df %>% column_to_rownames(., var = 'TAG')

# Make into wide format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Define levels
levels = ordered(colnames(df))

# Plot df_wide
ggplot(df_wide, aes(x = rowname, y = ordered(colname, levels=rev(levels)))) +
  
  # Fill colour with value
  geom_tile(aes(fill = value)) +
  
  # Colours of fill gradient. OOB = how to handle out of bounds.
  scale_fill_gradient2(low = "lightblue",
                       high = "red",
                       mid = "white",
                       midpoint = 25,
                       limit = c(0,50),
                       space = "Lab",
                       name="Number of annotations",
                       oob=scales::squish) +
  
  # Text on tiles with value number
  geom_text(aes(label = value), size = 3.5) + 
  
  # All cells equal size
  coord_fixed() +
  
  # Minimal theme to avoid weird borders
  theme_minimal() +
  
  # Labels on x-axis should be tilted (they overlap)
  theme(axis.text.x=element_text(angle = -90, hjust = 0, vjust = 0)) +
  
  # Labs
  labs(title = "Prediction errors - medium model",
       subtitle = "Confusion matrix of da_dacy_medium_ner_fine_grained",
       x = "da_dacy_medium_ner_fine_grained", 
       y = "DANSK gold annotations") #+
  
  # Theme and positioning
  # theme(plot.title = element_text(hjust = 0.5), 
  #       plot.subtitle = element_text(hjust = 0.5))


# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/medium_confusion_matrix_plot.png")
```
Large
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/large_confusion_matrix.csv", header=T)

# Change column names
colnames(df)[1] <- "TAG"
colnames(df)[12] <- "NOT TAGGED"
colnames(df)[20] <- "WORK OF ART"

# Column to index/rownames
df <- df %>% column_to_rownames(., var = 'TAG')

# Make into wide format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Define levels
levels = ordered(colnames(df))

# Plot df_wide
ggplot(df_wide, aes(x = rowname, y = ordered(colname, levels=rev(levels)))) +
  
  # Fill colour with value
  geom_tile(aes(fill = value)) +
  
  # Colours of fill gradient. OOB = how to handle out of bounds.
  scale_fill_gradient2(low = "lightblue",
                       high = "red",
                       mid = "white",
                       midpoint = 25,
                       limit = c(0,50),
                       space = "Lab",
                       name="Number of annotations",
                       oob=scales::squish) +
  
  # Text on tiles with value number
  geom_text(aes(label = value), size = 3.5) + 
  
  # All cells equal size
  coord_fixed() +
  
  # Minimal theme to avoid weird borders
  theme_minimal() +
  
  # Labels on x-axis should be tilted (they overlap)
  theme(axis.text.x=element_text(angle = -90, hjust = 0, vjust = 0)) +
  
  # Labs
  # Labs
  labs(title = "Prediction errors - large model",
       subtitle = "Confusion matrix of da_dacy_large_ner_fine_grained",
       x = "da_dacy_large_ner_fine_grained", 
       y = "DANSK gold annotations")# +
  
  # Theme and positioning
  # theme(plot.title = element_text(hjust = 0.5), 
  #       plot.subtitle = element_text(hjust = 0.5))

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/large_confusion_matrix_plot.png")
```

# NER MODEL PERFORMANCE
DOMAIN PERFORMANCE
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/domain_f1_wide.csv", header=T)

# Set model values as rownames
df <- df %>% column_to_rownames(., var = 'Model')

# Remove the across domains
df <- df %>% select(!(name="across_domains"))

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Order by custom ordering:
df_wide$rowname <- factor(df_wide$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained"))
df_wide$rowname <- fct_rev(df_wide$rowname)

# Plot
ggplot(df_wide, aes(y=value, x=rowname)) +
  # Geom_bar
  geom_point(size = 3.5,
          aes(color=colname),
          stat="identity") +

  geom_point(shape=1, size=3.5, colour="black")+

  scale_color_brewer(palette = "Set2") +

  coord_flip() + 
  
  # theme_minimal() +

  # Set labs
  labs(title = "F1-scores across domains",
       subtitle = "F1-performance of the NER fine-grained models",
       x = "Model",
       y = "F1-score",
       color = 'Domain')

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/domain_f1_wide_plot.png")
```
TAG PERFORMANCE
```{r}
# Load data
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/tag_f1_wide.csv", header=T)

# Set model values as rownames
df <- df %>% column_to_rownames(., var = 'Model')

df <- df %>% select(!(name="Domain"))

colnames(df)[length(colnames(df))] <- "WORK OF ART"

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Order by custom ordering:
df_wide$rowname <- factor(df_wide$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained"))
df_wide$colname <- factor(df_wide$colname)
df_wide$colname <- fct_rev(df_wide$colname)

# Plot
ggplot(df_wide, aes(y=value, x=colname)) +
  # Geom_bar
  geom_point(size = 3.5,
          aes(color=colname),
          stat="identity") +

  geom_point(shape=1, size=3.5, colour="black")+

  #scale_color_brewer() +#palette = "") +

  coord_flip() + 
  
  guides(color = guide_legend(reverse=TRUE)) +

  #theme_minimal() +

  # Set labs
  labs(title = "F1-scores across domains",
       subtitle = "F1-performance of the NER fine-grained models",
       x = "Model",
       y = "F1-score",
       color = 'Tag') +
  
  facet_wrap(~rowname, ncol=3)

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/ner_models_performance/tag_f1_wide_plot.png")
```

# OTHER MODELS PERFORMANCE
GENERAL PERFORMANCE
```{r}
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/domain_f1_long.csv", header=T)

# Set model values as rownames
df <- df %>% column_to_rownames(., var = 'Model')

# Remove the across domains
df <- df %>% select((name="across_domains"))

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Order by custom ordering:
df_wide$rowname <- factor(df_wide$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained", "saattrupdan/nbailab-base-ner-scandi", "da_dacy_large_trf", "da_dacy_medium_trf", "da_dacy_small_trf", "da_core_news_lg", "da_core_news_md","da_core_news_sm"))

# Reverse order
df_wide$rowname <- fct_rev(df_wide$rowname)

# Plot
ggplot(df_wide, aes(color=rowname, y=value, x=rowname)) +
  # Geom_bar
  geom_point(#position = position_dodge(width = 0.7),
           #width=0.7,
          size = 2.5,
          aes(color=rowname),
          stat="identity") + #,
           #colour="black") +
  
  # Add text with F1-scores
  geom_text(aes(label=round(value, 2)), hjust=1.4, color="black", size=3.5) +
  
  guides(color = guide_legend(reverse=TRUE)) +
  
  geom_point(shape=1, size=2.5, colour="black")+

  #scale_color_brewer(palette = "Set2") +

  coord_flip() + 

  # Set labs
  labs(title = "F1-scores on DANSK",
       subtitle = "F1-performance of Danish SOTA models",
       x = "Model",
       y = "F1-score",
       color = 'Model')

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/f1.png")
```
DOMAIN MODEL PERFORMANCE
```{r}
# Load data
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/domain_f1_long.csv", header=T)

# Set model values as rownames
df <- df %>% column_to_rownames(., var = 'Model')

# Remove the across domains
df <- df %>% select(!(name="across_domains"))

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Order by custom ordering:
df_wide$rowname <- factor(df_wide$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained", "saattrupdan/nbailab-base-ner-scandi", "da_dacy_large_trf", "da_dacy_medium_trf", "da_dacy_small_trf", "da_core_news_lg", "da_core_news_md","da_core_news_sm"))

# Reverse order
df_wide$rowname <- fct_rev(df_wide$rowname)

# Plot
ggplot(df_wide, aes(color=colname, y=value, x=rowname)) +
  # Geom_bar
  geom_point(#position = position_dodge(width = 0.7),
           #width=0.7,
          size = 2.5,
          aes(color=colname),
          stat="identity") + #,
           #colour="black") +
    
  geom_point(shape=1, size=2.5, colour="black") +

  scale_color_brewer(palette = "Set2") +

  coord_flip() + 

  # Set labs
  labs(title = "F1-scores across domains",
       subtitle = "F1-performance of Danish SOTA models",
       x = "Model",
       y = "F1-score",
       color= 'Domain')

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/domain_f1.png")
```
TAG MODEL PERFORMANCE
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/tag_f1_wide.csv", header=T)

# Set model values as rownames
df <- df %>% column_to_rownames(., var = 'Model')

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Factor by right order
df_wide$rowname <- factor(df_wide$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained", "saattrupdan/nbailab-base-ner-scandi", "da_dacy_large_trf", "da_dacy_medium_trf", "da_dacy_small_trf", "da_core_news_lg", "da_core_news_md","da_core_news_sm"))

# Reverse order
df_wide$rowname <- fct_rev(df_wide$rowname)

# Plot 
ggplot(df_wide, aes(color=colname, y=value, x=rowname)) + 
  # Geom_bar
  geom_point(#position = position_dodge(width = .8),
           #width=.8,
          size=2.5,
           stat="identity") +#,
           # colour="black") +
  
  geom_point(shape=1, size=2.5, colour="black")+
  
  scale_color_brewer(palette = "Set2") +  
  
  coord_flip() +
  
  #theme_minimal() +
  
  # Set labs
  labs(title = "F1-scores across tags",
       subtitle = "F1-performance of Danish SOTA models",
       x = "Model", 
       y = "F1-score",
       color = 'Tag')

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/tag_f1.png")
```












# OLD, MIGHT NOT USE:
output/DANSK_initial_interrater/kappa_also_non_annotated.csv 
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_initial_interrater/kappa_also_non_annotated.csv", header=T)

# Clean up dataset
df <- df %>% select(!(name=c("X","rater_avg"))) # Remove first and last columns
colnames(df) <- c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10")#, "rater_avg") # Change colnames

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Have annotators as factors
df_wide$rowname <- as.factor(df_wide$rowname) 
df_wide$colname <- as.factor(df_wide$colname) 

# Remove rows with kappa score between same annotators
df_wide = df_wide %>% filter(colname != rowname)

# Create plot
ggplot(df_wide, aes(x = reorder(rowname, sort(as.numeric(rowname), decreasing=T)), y = value, fill=reorder(rowname, sort(as.numeric(rowname),decreasing=T)))) +
  # Violin plot, don't trim 
  geom_violin(trim=FALSE) +
  
  # Include boxplot also
  geom_boxplot(width=.1,
               fill="white") + 
  
  # Set theme
  theme(plot.title = element_text(hjust = 0.5), 
        plot.subtitle = element_text(hjust = 0.5),
        legend.position="right") +
  
  # Set labs
  labs(title = "Cohen's Kappa all tokens",
       subtitle = "Cohens Kappa scores between annotators, when including all tokens",
       x = "Annotator", 
       y = "Cohen's Kappa",
       fill='Annotator')

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_initial_interrater/kappa_also_non_annotated_plot.png")
```
output/DANSK_initial_interrater/kappa_annotated.csv
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_initial_interrater/kappa_annotated.csv", header=T)

# Clean up dataset
df <- df %>% select(!(name=c("X","rater_avg"))) # Remove first and last columns
colnames(df) <- c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10")#, "rater_avg") # Change colnames

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Have annotators as factors
df_wide$rowname <- as.factor(df_wide$rowname) 
df_wide$colname <- as.factor(df_wide$colname) 

# Remove rows with kappa score between same annotators
df_wide = df_wide %>% filter(colname != rowname)

# Create plot
ggplot(df_wide, aes(x = reorder(rowname, sort(as.numeric(rowname), decreasing=T)), y = value, fill=reorder(rowname, sort(as.numeric(rowname),decreasing=T)))) +  
  
  # Violin plot, don't trim 
  geom_violin(trim=FALSE) +
  
  # Include boxplot also
  geom_boxplot(width=.1,
               fill="white") + 
  
  # Set theme
  theme(plot.title = element_text(hjust = 0.5), 
        plot.subtitle = element_text(hjust = 0.5),
        legend.position="right") +
  
  # Set labs
  labs(title = "Cohen's Kappa all tokens",
       subtitle = "Cohens Kappa scores between annotators, only including annotated tokens",
       x = "Annotator", 
       y = "Cohen's Kappa",
       fill='Annotator')

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_initial_interrater/kappa_annotated_plot.png")
```
output/DANSK_initial_interrater/tag_counts.csv SKIP BELOW ON TAG_COUNTS; DATA SHOWS NUMBER OF TOKENS WITH TAGS, INSTEAD OF NUMBER OF TAGS IN DOCUMENTS
```{r}
# Load dataset
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/DANSK_initial_interrater/tag_counts.csv", header=T)

# Clean up dataset
colnames(df) <- c("Tag ","1", "2", "3", "4", "5", "6", "7", "8", "9", "10")#, "rater_avg") # Change colnames

# Set Tag column as row names
rownames(df) <- df$Tag

# Remove Tag column from columns
df <- df %>% select(c(2:length(colnames(df))))

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# Have annotators as factors
df_wide$rowname <- as.factor(df_wide$rowname)
df_wide$colname <- as.factor(df_wide$colname)

# Create plot
ggplot(df_wide, aes(x = rowname, y = value, fill=rowname)) + 
  
  # Make boxplot
  geom_boxplot() + 
  
  # Set theme
  theme(plot.title = element_text(hjust = 0.5), 
        plot.subtitle = element_text(hjust = 0.5),
        legend.position="right") +
  
  # Set labs
  labs(title = "Cohen's Kappa all tokens",
       subtitle = "Cohens Kappa scores between annotators, only including annotated tokens",
       x = "Annotator", 
       y = "Cohen's Kappa",
       fill='Annotator')

```
something
```{r}
# Load data
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/domain_f1_long.csv", header=T)

# Set model values as rownames
df <- df %>% column_to_rownames(., var = 'Model')

# Remove the across domains
df <- df %>% select(!(name="across_domains"))

df

# Make into long format
df_wide <- df %>%
  rownames_to_column() %>%
  gather(colname, value, -rowname)

# As factors
df_wide$rowname <- as.factor(df_wide$rowname) 
df_wide$colname <- as.factor(df_wide$colname) 

# Order by custom ordering:
df_wide$rowname <- factor(df_wide$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained", "saattrupdan/nbailab-base-ner-scandi", "da_dacy_large_trf", "da_dacy_medium_trf", "da_dacy_small_trf", "da_core_news_lg", "da_core_news_md","da_core_news_sm"))

# # Plot 
# ggplot(df_wide, aes(y=value, x=rowname, fill=rowname)) + 
#   # Geom_bar
#   geom_bar(position = position_dodge(width = 0.7),
#            width=0.7,
#            stat="identity",
#            #fill="white",
#            colour="black") +
#   
#   scale_fill_brewer(palette = "Set2") +  
#   
#     # Add text with F1-scores
#   geom_text(aes(label=round(value, 2)), vjust=1.6, color="white", size=3.5, position = position_dodge(0.7)) +
#   
#   # Set theme
#   theme(plot.title = element_text(hjust = 0.5), 
#         plot.subtitle = element_text(hjust = 0.5),
#         legend.position="right") +
#   
#   # Set labs
#   labs(title = "F1-scores across domains",
#        subtitle = "F1-performance of Danish SOTA models",
#        x = "Model", 
#        y = "F1-score",
#        fill = 'Model') +
#   
#   theme(axis.text.x=element_blank()) +  
#   #theme(axis.text.x=element_text(angle = -90, hjust = 0, vjust = 0)) +
#   
#   # Facet_wrap
#   facet_wrap(~colname, ncol=3)

# Plot 
ggplot(df_wide, aes(y=value, x=colname, color=colname)) + 
  # Geom_bar
  geom_point(#position = position_dodge(width = 1),
           #width=1,
           stat="identity") + #,
           #fill="white",
           #colour="black") +
  
  coord_flip() + 
  
  scale_color_brewer(palette = "Set2") +  
  
  # Add text with F1-scores
  #geom_text(aes(label=round(value, 2)), hjust=1.6, color="black", size=4, position = position_dodge(1)) +
  
  # Set theme
  # theme(plot.title = element_text(hjust = 0.5), 
  #       plot.subtitle = element_text(hjust = 0.5),
  #       legend.position="right") +
  # 
  # Set labs
  labs(title = "F1-scores across domains",
       subtitle = "F1-performance of Danish SOTA models",
       x = "",#"Domain", 
       y = "F1-score",
       fill= 'Domain') +
  
  theme(axis.text.x=element_blank())# +
  #theme(axis.text.x=element_text(angle = -90, hjust = 0, vjust = 0)) +
  
  # Facet_wrap
  #facet_wrap(~rowname, ncol=2)

# Save plot
ggsave("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/domain_f1_long_plot.png")
```
output/other_models_performance/domain_f1_long.csv
```{r}
# Load data
df <- read.csv("/Users/emiltrencknerjessen/Desktop/priv/DANSK_eval/output/other_models_performance/domain_f1_long.csv", header=T)

# Keep only the across domains
df <- df %>% select(c("rowname"="Model", "value"="across_domains"))

# Factor by right order
df$rowname <- fct_rev(factor(df$rowname, levels=c("da_dacy_large_ner_fine_grained", "da_dacy_medium_ner_fine_grained", "da_dacy_small_ner_fine_grained", "saattrupdan/nbailab-base-ner-scandi", "da_dacy_large_trf", "da_dacy_medium_trf", "da_dacy_small_trf", "da_core_news_lg", "da_core_news_md","da_core_news_sm")))

palette_blues <- colorRampPalette(colors = c("white", "#004b88"))(20)
palette_blues

# Plot
ggplot(df, aes(fill=rowname, y=value, x=rowname)) + 
  # Geom_bar
  geom_bar(position = position_dodge(width = .8),
           width=.7,
           stat="identity",
           colour="black") +
  
  # Add text with F1-scores
  geom_text(aes(label=round(value, 2)), hjust=1.6, color="black", size=4.5, position = position_dodge(0.8)) +
  
  scale_fill_brewer(palette = "palette_blues") +  

  # Set theme
  theme(plot.title = element_text(hjust = 0.5), 
        plot.subtitle = element_text(hjust = 0.5),
        legend.position="none") +
  
  coord_flip() +
  
  # Let x-axis dodge to avoid clutter
  #scale_x_discrete(guide = guide_axis(n.dodge=2)) +
  
  # Set labs
  labs(title = "F1-scores",
       subtitle = "F1-performance of Danish SOTA models",
       x = "Model", 
       y = "F1-score")

```



